(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{621:function(s,t,e){"use strict";e.r(t);var a=e(12),n=Object(a.a)({},(function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h2",{attrs:{id:"前言"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#前言"}},[s._v("#")]),s._v(" 前言")]),s._v(" "),e("p",[s._v("众所周知，ESP-IDF 在 Windows 下的安装十分困难，编译速度巨慢。通常情况下，编译一个 HelloWorld 程序也需要5分钟及以上。\n实测发现，ESP-IDF 在 Linux (WSL) 下的编译速度极快，一个同样的 HelloWorld 程序仅需 10 秒即可完成编译。")]),s._v(" "),e("p",[s._v("本文主要介绍在 WSL 上安装 ESP-IDF 及其 VSCode 插件的步骤。")]),s._v(" "),e("h2",{attrs:{id:"设置-windows-环境"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#设置-windows-环境"}},[s._v("#")]),s._v(" 设置 Windows 环境")]),s._v(" "),e("h3",{attrs:{id:"安装必需软件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#安装必需软件"}},[s._v("#")]),s._v(" 安装必需软件")]),s._v(" "),e("p",[s._v("Windows 上所需软件有：")]),s._v(" "),e("ul",[e("li",[s._v("Visual Studio Code")]),s._v(" "),e("li",[s._v("WSL 2")]),s._v(" "),e("li",[s._v("WSL Ubuntu 发行版 (Microsoft Store)")]),s._v(" "),e("li",[s._v("Python 3.9")])]),s._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"title"},[s._v("注意")]),e("ul",[e("li",[s._v("WSL 仅在 Windows 10+上可用，低版本 Windows 用户请使用虚拟机！")]),s._v(" "),e("li",[s._v("WSL Ubuntu 版本应为 20.04+，本文中使用 22.04 版。")])])]),e("h3",{attrs:{id:"设置-wsl"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#设置-wsl"}},[s._v("#")]),s._v(" 设置 WSL")]),s._v(" "),e("p",[s._v("打开 WSL 窗口，执行下列指令以安装必须软件包：")]),s._v(" "),e("div",{staticClass:"language-Bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt")]),s._v(" update\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" flex bison gperf python3-pip python3-venv python3-setuptools cmake ninja-build ccache libffi-dev libssl-dev dfu-util\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h3",{attrs:{id:"配置-vscode"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#配置-vscode"}},[s._v("#")]),s._v(" 配置 VSCode")]),s._v(" "),e("ol",[e("li",[e("p",[s._v("请手动从 VSCode - 扩展 界面安装 "),e("code",[s._v("Remote - WSL")]),s._v("（扩展ID为 "),e("code",[s._v("ms-vscode-remote.remote-wsl")]),s._v(")；")])]),s._v(" "),e("li",[e("p",[s._v("点击 VSCode 左下角的绿色图标，出现类似图中的页面,选择"),e("code",[s._v("New WSL Window")]),s._v("，此时应打开一个新的 VSCode 窗口，左下角绿色图标变为"),e("code",[s._v("WSL:Ubuntu-22.04")]),s._v(";\n"),e("img",{attrs:{src:"/imgs/WSL-1.png",alt:"WSL-1"}})])]),s._v(" "),e("li",[e("p",[s._v("在新打开的窗口中，找到 扩展 页面，搜索 "),e("code",[s._v("Espressif IDF")]),s._v("，点击如图中所示"),e("code",[s._v("安装在WSL:Ubuntu-22.04中")]),s._v("按钮，等待安装完成；\n"),e("img",{attrs:{src:"/imgs/WSL-2.png",alt:"WSL-2"}})])]),s._v(" "),e("li",[e("p",[s._v("安装完成后，按图示操作，改好选择下载源，更改安装路径，点 [Install]，然后继续等待；\n"),e("img",{attrs:{src:"/imgs/WSL-3.png",alt:"WSL-3"}})])])]),s._v(" "),e("h3",{attrs:{id:"给-esp-idf-打补丁"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#给-esp-idf-打补丁"}},[s._v("#")]),s._v(" 给 ESP-IDF 打补丁")]),s._v(" "),e("p",[s._v("实测发现，进行到这里，已经可以超快速编译，但是仍不能烧录程序。按照官方文档，需要安装 usbipd 映射串口，然后会遇到权限问题。")]),s._v(" "),e("p",[s._v("这里我们利用 IDF 的一个神奇特性（Bug），即烧录的时候调用的是本地的 PowerShell.exe，顺理成章地，调用到的 Python 也是本地的。\n因此，我们只需在本地安装相应依赖，就可完美解决问题。下列步骤:")]),s._v(" "),e("ol",[e("li",[s._v("从 WSL Ubuntu 中复制相应文件或者"),e("a",{attrs:{href:"/downloads/esp-idf-wsl-patch.zip"}},[s._v("下载")])])]),s._v(" "),e("ul",[e("li",[s._v("${IDF_PATH}/requirements.txt")]),s._v(" "),e("li",[s._v("${IDF_PATH}/tools/kconfig_new/esp-windows-curses")])]),s._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"title"},[s._v("提示")]),e("p",[s._v("请将复制出来的 "),e("code",[s._v("requirements.txt")]),s._v(" 及 "),e("code",[s._v("esp-windows-curses")]),s._v(" 文件夹置于同一个文件夹下。")])]),e("p",[s._v("修改 "),e("code",[s._v("requirements.txt")]),s._v(" ,将下列行（通常在末尾）")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("file://${IDF_PATH}/tools/kconfig_new/esp-windows-curses; sys_platform == 'win32'\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("改为")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("./esp-windows-curses; sys_platform == 'win32'\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("然后打开 Windows 终端（你喜欢就好），导航至保存的文件目录下，执行")]),s._v(" "),e("div",{staticClass:"language-PowerShell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-powershell"}},[e("code",[s._v("pip install "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("r requirements"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("txt\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("静待片刻，即可安装完成。（若不成功请尝试换源）")]),s._v(" "),e("h2",{attrs:{id:"测试-esp-idf-功能"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#测试-esp-idf-功能"}},[s._v("#")]),s._v(" 测试 ESP-IDF 功能")]),s._v(" "),e("p",[s._v("在连接到 WSL 的 VSCode 窗口内打开一个文件夹，\n按下 "),e("code",[s._v("Ctrl + E")]),s._v("，紧接着按下"),e("code",[s._v("C")]),s._v("，选择"),e("code",[s._v("Use current directory")]),s._v("，即可用模板创建一个 IDF 工程。\n接着，连接开发板，在下边栏 [/dev/ttyUSB1] 处选择串口；再进行编译、烧录；(点击🔥图标一步到位)")]),s._v(" "),e("p",[s._v("片刻过后，你将可以从串口监视器看到 Log！")]),s._v(" "),e("h2",{attrs:{id:"结束啦"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#结束啦"}},[s._v("#")]),s._v(" 结束啦")]),s._v(" "),e("p",[s._v("现在，您可以享受 10s 飞速编译和烧录啦！")])])}),[],!1,null,null,null);t.default=n.exports}}]);